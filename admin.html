<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel Administrativo - Cifras ICM</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .admin-container { max-width: 900px; margin: 20px auto; padding: 20px; background: white; border-radius: 8px; }
        textarea { width: 100%; height: 300px; font-family: monospace; margin-top: 10px; padding: 10px; border: 1px solid #ccc; }
        .controles { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .resultado { background: #eef; padding: 15px; border-radius: 5px; margin-top: 20px; border: 1px dashed #004a8d; position: relative; }
        .btn-gerar { background: #28a745; color: white; padding: 15px; border: none; width: 100%; cursor: pointer; font-size: 1.1rem; }
        .copy-btn { position: absolute; right: 10px; top: 10px; background: #004a8d; color: white; border: none; padding: 5px 10px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="admin-container">
        <h2>Gerador de Arquivos JSON</h2>
        <p>Cole a cifra abaixo e clique em "Gerar JSON".</p>
        
        <div class="controles">
            <input type="text" id="admNum" placeholder="Número (ex: 2201)">
            <input type="text" id="admTitulo" placeholder="Título do Louvor">
            <input type="text" id="admTom" placeholder="Tom (ex: G)">
        </div>

        <textarea id="admLetra" placeholder="Cole a letra com cifras aqui..."></textarea>
        
        <button class="btn-gerar" onclick="gerarJSON()">Gerar Arquivo JSON</button>

        <div id="blocoResultado" style="display:none;">
            <div class="resultado">
                <button class="copy-btn" onclick="copiarTexto()">Copiar JSON</button>
                <pre id="jsonSaida"></pre>
            </div>
            <p style="color: red; font-size: 0.9rem; margin-top: 10px;">
                * Salve este conteúdo como um arquivo chamado <span id="nomeArquivoHint"></span>.json dentro da pasta /cifras/
            </p>
        </div>
    </div>

    <script>
        function gerarJSON() {
            const num = document.getElementById('admNum').value;
            const titulo = document.getElementById('admTitulo').value;
            const tom = document.getElementById('admTom').value;
            let letra = document.getElementById('admLetra').value;

            // Lógica Mágica: Envolve tudo que parece acorde com <b></b>
            // Esta Regex procura letras maiúsculas isoladas ou seguidas de #, b, m, 7, etc.
            let letraFormatada = letra.replace(/(?<=^|[\s])([A-G][#b]?(m|maj|dim|aug|sus)?[245679]?(?=\s|$))/g, "<b>$1</b>");

            const objetoFinal = {
                numero: num,
                titulo: titulo,
                tom: tom,
                corpo: letraFormatada
            };

            const jsonString = JSON.stringify(objetoFinal, null, 4);
            document.getElementById('jsonSaida').textContent = jsonString;
            document.getElementById('nomeArquivoHint').textContent = num;
            document.getElementById('blocoResultado').style.display = 'block';
        }

        function copiarTexto() {
            const texto = document.getElementById('jsonSaida').textContent;
            navigator.clipboard.writeText(texto);
            alert("JSON copiado! Agora é só salvar o arquivo.");
        }
    </script>
</body>
</html>
