function gerarJSON() {
    const titulo = document.getElementById('admTitulo').value.trim();
    const artista = document.getElementById('admArtista').value.trim();
    const tom = document.getElementById('admTom').value.trim();
    let letra = document.getElementById('admLetra').value;

    if(!titulo || !artista) {
        alert("Título e Artista são obrigatórios para gerar o nome do arquivo!");
        return;
    }

    const identificadorUnico = `${titulo} - ${artista}`;

    // NOVA REGEX ATUALIZADA
    let letraFormatada = letra.replace(/(?<=^|[\s])([A-G][#b]?(?:m|maj|M|dim|aug|sus|add|alt)?(?:(?:1[13]|2|4|5|6|7|9))?(?:M|maj|min)?(?:\/[A-G][#b]?)?)(?=\s|$)/g, "<b>$1</b>");

    const objetoFinal = {
        titulo: titulo,
        artista: artista,
        tom: tom,
        corpo: letraFormatada
    };

    const linhaIndice = `{ "num": "${identificadorUnico}", "titulo": "${titulo} (${artista})" },`;

    document.getElementById('jsonSaida').textContent = JSON.stringify(objetoFinal, null, 4);
    document.getElementById('linhaDados').textContent = linhaIndice;
    document.getElementById('labelNomeArquivo').textContent = identificadorUnico;
    
    document.getElementById('blocoResultado').style.display = 'block';
    document.getElementById('blocoResultado').scrollIntoView({ behavior: 'smooth' });
}
